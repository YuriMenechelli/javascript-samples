<html>
<body>
<canvas width="640" height="480" id="meuCanvas">
</canvas>

<script>
	
	var larguraLinha = 1;
	
	var meuCanvasLegal = document.getElementById("meuCanvas");
	var ctx = meuCanvasLegal.getContext("2d");
    ctx.fillStyle = '#8ED6FF';
    ctx.lineWidth = larguraLinha;
    ctx.strokeStyle = 'black';

	var x = 10;
	var y = 10;
	var direcaoX = 15;
	var direcaoY = 0;
	var largura = 40;
	var altura = 40;

	function limpar(){
		ctx.clearRect(0,0,640,480);	
	}
	
	function atualizar(){
	
		if( x + largura > meuCanvasLegal.width  ){
			direcaoX = 0;
			direcaoY = 10;	
		}
		
		if( y + altura > meuCanvasLegal.height ){
			direcaoX = -10;
			direcaoY = 0;	
		}
	
		if( x < 0 ){
			direcaoX = 0;
			direcaoY = -10;	
		}	
	
		if( y < 0 ){
			direcaoX = 10;
			direcaoY = 0;	
		}	

		x = x + direcaoX;
		y = y + direcaoY;
	}

	function exibir(){
		ctx.beginPath();
        ctx.rect(x, y, largura, altura);
        ctx.fill();
        ctx.stroke();
	}
	
	function executar(){
		limpar();
		atualizar();
		exibir();
		setTimeout( executar, 30 );
	}

	console.debug("largura do canvas = " + meuCanvasLegal.width);
	executar();

</script>

</body>
</html>